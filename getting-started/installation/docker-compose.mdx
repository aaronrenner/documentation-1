---
title: 'Docker'
description: 'This deployment leverages `docker-compose` to deploy Hoop on local or remote machines for solution assessment.'
---

## Supported Operational Systems

<CardGroup cols={2}>
  <Card title="Linux" icon="linux">
    Tested on Ubuntu 18-22.10, Amazon Linux 2, CentOS 7, and Fedora 34-37. amd64 / x86_64
  </Card>
  <Card title="MacOS" icon="apple">
    Intel based and Apple Silicon (M1/M2) Macs
  </Card>
</CardGroup>

<Warning>
  arm64 (Apple Silicon) is supported via virtualization. The setup may take more time to bootstrap when using this architecture.
</Warning>

## Required tooling

<Steps titleSize="h3">
  <Step title="GIT" icon="git">
   [Install or update to](https://git-scm.com/downloads) version 2.7.0 or greater
   <Info>Run `git version` to check which version you have installed</Info>
  </Step>
  <Step title="Docker" icon="docker">
    Install or update to Docker version 20.10.0 or greater
    <CardGroup cols={2}>
      <Card
        title="Install Docker for Linux"
        icon="linux"
        iconType="brands"
        href="https://docs.docker.com/engine/install/ubuntu/#install-using-the-convenience-script"
      />
      <Card
        title="Install Docker for MacOS"
        iconType="brands"
        icon="apple"
        href="https://docs.docker.com/desktop/install/mac-install/"
      />
    </CardGroup>
  </Step>
  <Step title="Docker Compose" icon="docker">
    Install or update Docker Compose to version 2.4.0 or greater
    <Info>Run `docker compose version` to check which version you have installed</Info>
    <CardGroup cols={2}>
      <Card
        title="Install Docker Compose for Linux"
        icon="linux"
        iconType="brands"
        href="https://docs.docker.com/desktop/install/linux-install/"
      >
        It comes installed with Docker engine, but you can also do the standalone installation
      </Card>
      <Card
        title="Docker Compose for MacOS"
        iconType="brands"
        icon="apple"
      >
        No need to install, it comes with Docker Desktop for MacOS
      </Card>
    </CardGroup>
  </Step>
</Steps>

## Download & Launch

<Steps>
  <Step title="Clone the repository">
    Download the hoop repository and navigate to the docker-compose installer directory.

    ```sh
    git clone git@github.com:hoophq/hoop.git && cd hoop/deploy/docker-compose
    ```
  </Step>

  <Step title="Find your local IP">
    Get the IP address of your machine. This IP address should be reachable from the network where the docker containers will be running.

    ```sh
    # this command gives you the IP address
    # of your machine in the local network
    # in the first line of its result
    ifconfig | grep "inet " | grep -Fv 127.0.0.1 | awk '{print $2}'
    ```

    <Note>
    This should output an IP address like `192.168.x.y`. If you're running the setup without a reachable DNS, specify the IP address with the suffix `.nip.io`. This service allows mapping any IP address to a valid DNS. For example, if your IP address is `
    </Note>
  </Step>

  <Step title="Set the .env file">
    Configure the environment variable with your IP address.

    ```sh
    cat - > .env <<EOF
    HOOP_PUBLIC_HOSTNAME=<192.168.x.y>.nip.io
    EOF
    ```

    <Warning>
      Remember to replace the `<192.168.x.y>` with your IP address.
    </Warning>
  </Step>
  <Step title="Run">
    With everything properly configured, run the docker-compose command.

    ```sh
    docker-compose up
    ```

    <Note>
      The following ports will need to be accessible when deployed remotely:
       - 8009: Used by the Hoop Webapp
       - 8010: Hoop gRPC port
       - 8080: Default identity provider (Zitadel)
       - 443: nginx proxy
    </Note>
  </Step>
</Steps>

## Access and Get Started with hoop.dev

Access hoop.dev's developer portal and set up your first user with a default user, configure your first demo PostgreSQL connection, and see how you can access it from inside our interface and from a database client of your choice.

#### Sign In to the developer portal

<Steps>
  <Step title="Access in the Browser">
    Now, access your instance via `https://app.<192.168.x.y>.nip.io`

    <Warning>
    If you use self-signed certificates, the browser will warn that your connection is not private. Make sure to bypass this warning and proceed with your connection.

    This warning could appear more than once because the app will redirect you to `https://auth.<192.168.x.y>.nip.io`.

    If the browser redirects you to the `/logout` endpoint, edit the URL by removing this suffix and hitting enter.
    </Warning>

    <Frame>
      <img
        src="/images/getting-started/installation/signin-zitadel.png"
      />
    </Frame>
  </Step>
  <Step title="Type the default user email value">
    Type `admin` for the e-mail input and click on Next
    <Frame>
      <img
        src="/images/getting-started/installation/login-page-admin-filled.png"
      />
    </Frame>
  </Step>
  <Step title="Type the default password">
    Type `Password1` for the password input and click on Next
    <Frame>
      <img
        src="/images/getting-started/installation/login-page-password-filled.png"
      />
    </Frame>
  </Step>
  <Step title="Skip the 2-factor authentication information">
    <Frame>
      <img
        src="/images/getting-started/installation/login-page-skip-2fs.png"
      />
    </Frame>
  </Step>

  <Step title="Change the default password and proceed">
    <Frame>
      <img
        src="/images/getting-started/installation/login-page-reset-pass.png"
      />
    </Frame>
  </Step>
</Steps>

Once you finish the setup, you will be redirected to the main page of the developer portal.

<Frame>
  <img
    src="/images/getting-started/installation/successful-sign-in.jpg"
  />
</Frame>

#### Create your first connection

Now that you have access to the developer portal, let's create your first connection. We have a demo PostgreSQL connection that you can use to test the setup. Follow this guide to create your PostgreSQL demo.

<Steps>
  <Step title="Start with a Demo set up">
    In the main page click on **Quick start** button inside the **Start with a Demo Setup" area.
    <Frame>
      <img
        src="/images/getting-started/installation/dev-portal-home-click-demo.png"
      />
    </Frame>
  </Step>

  <Step title="Interact with the PostgreSQL">
    Let's make sure the setup is working by creating and interacting with a Postgres connection.

    Write the below SQL statement to fetch the "customers" table.

    ```sql
    SELECT email, firstname, phone, region, username FROM customers LIMIT 2;
    ```

    It should show you the first two rows of the table like demonstrated in the image below:

    <Frame>
      <img
        src="/images/getting-started/installation/postgres-demo-sql-query.jpg"
      />
    </Frame>
  </Step>
</Steps>

#### Connecting to your IDE

In this step, we'll connect to Postgres using your favorite IDE via Hoop.

<Steps>
  <Step title="Access your terminal and Install hoop.dev's CLI">
    Install the [Hoop Command Line](/getting-started/cli) in your host machine
  </Step>

  <Step title="Configure and Login via CLI">
    ```sh
    # configure it only once in your local machine
    hoop config create --api-url https://app.<192.168.x.y>.nip.io --tls-ca path/to/ca.crt

    hoop login
    ```

    <Tip>
      The `--tls-ca` option is required only when using self signed certificates.

      Also, don't forget to replace `<192.168.x.y>` with your actual IP address.
    </Tip>
  </Step>

  <Step title="Run the command to connect to your PostgreSQL">
    ```sh
    hoop connect <name-of-the-connection>
    ```
    If you are following this guide as is, the command will look like this:
    ```sh
    hoop connect postgres-demo
    ```
  </Step>
  <Step title="Get the credentials and connect to it">
    Hoop securely connects to the database and tunnels it to your localhost. These credentials are only available for the duration of the connection and for your local machine only.
    ```sh
    $ hoop connect postgres-demo
    connection: postgres-demo | session: 4619c80f-7166-487c-8c9f-9609e59ae5d6

    --------------------postgres-credentials--------------------
          host=127.0.0.1 port=5433 user=noop password=noop
    ------------------------------------------------------------
    ready to accept connections!
    ```
  </Step>
</Steps>

<Tip>
See our [Quick Start with Postgres](/quickstarts/postgres) for more information on how to interact with it.
</Tip>


## Inviting your coworkers to use Hoop

<Note>
As default, we use [Zitadel](https://github.com/zitadel/zitadel) as the identity provider for Hoop. If you want to change it, go to the [customization section](#customization) in this page to see how to do it.
</Note>

This section explains how to onboarding new users on Zitadel administrative UI.

<Note>
The login used to authenticate to Hoop is also an admin on Zitadel.
</Note>

<Steps>
  <Step title="Access Zitadel admin panel">
    Go to `https://auth.<192.168.x.y>.nip.io`
    <Info>remember to replace `<192.168.x.y>` with your actual IP address, if you are setting it up locally. If you are setting it up on a cloud provider, replace it with the domain you have configured</Info>
  </Step>

  <Step title="Navigate to hoophq settings">
    Go to **Default Settings** (top right button) and click on `hoophq` organization.
    <Frame>
      <img
        src="/images/getting-started/installation/zitadel-panel-default-settings.png"
      />
    </Frame>
  </Step>

  <Step title="Add a new user">
    Click on **Users** (top menu) > **New** and fill the form to create a new user
    <Tip>
      Make sure to check the option: **Set Initial Password**. This option does not depend on sending an email which is unavailable for this setup.
    </Tip>
    <Frame>
      <img
        src="/images/getting-started/installation/zitadel-new-user.png"
      />
    </Frame>
  </Step>

  <Step title="Associate the user to the project">
    Inside the new user, click on **Authorizations**:
    <Frame>
      <img
        src="/images/getting-started/installation/zitadel-new-user-authorization.png"
      />
    </Frame>
  </Step>

  <Step title="Add new authorization">
    Select the project **hoopdev** and click on Next and then Save.
    <Frame>
      <img
        src="/images/getting-started/installation/zitadel-associate-user.jpg"
      />
    </Frame>
  </Step>

  <Step title="Share the credentials with your colleague">
    Share the user's login and password with your colleague. They can now authenticate in the Hoop Instance using these credentials in the same process as you did first to authenticate
  </Step>
</Steps>

## Customization

### Custom Identity Provider

<Tip>
Refer to the [SSO documentation](/configure/idp/get-started) for instructions on how to obtain these values from your identity provider.
</Tip>

```sh
cat - > .env <<EOF
HOOP_PUBLIC_HOSTNAME=<host-ip>.nip.io
IDP_ISSUER=
IDP_CLIENT_ID=
IDP_CLIENT_SECRET=
IDP_AUDIENCE=
EOF
docker-compose -f docker-compose-custom-idp.yml up
```

---

A success launch will return the logs of the gateway and the agent

```log
hoop-gateway-1  | (...) starting servers
hoop-gateway-1  | (...) starting gateway at 0.0.0.0:8010
hoop-gateway-1  | (...) server transport created, tls=false
(...)
hoop-agent-1    | (...) connected with success to <$HOOP_PUBLIC_HOSTNAME>:443
```

### TLS

This installation comes with TLS enabled by default using self signed certificates. It will generate the certificates by default on a host volume.

- `hoop/deploy/docker-compose/hoopdata/tls/ca.crt`: the certificate authority (Root CA)
- `hoop/deploy/docker-compose/hoopdata/tls/server.crt`: the server certificate
- `hoop/deploy/docker-compose/hoopdata/tls/server.key`: the server private key

<Tip>
You could use your own certificates, just make sure to add the files in their respective paths. See the section below.
</Tip>

#### Let's Encrypt (optional)

This section explains how to issue a valid certificate for your Hoop instance with [certbot](https://certbot.eff.org/).

> This guide requires a valid domain and access to manage it's own DNS.

- Clone the Hoop project into your local machine

```sh
git clone git@github.com:hoophq/hoop.git && cd hoop/deploy/docker-compose
```

- Execute the command below to issue a new certificate and add the **TXT** record in your DNS management system

```sh
HOOP_PUBLIC_HOSTNAME=
docker run -v ./hoopdata/tls/:/etc/letsencrypt/archive/ \
    --rm -it certbot/certbot \
    -d "*.$HOOP_PUBLIC_HOSTNAME" \
    --manual --preferred-challenges dns certonly \
    --agree-tos \
    --register-unsafely-without-email
```

- Copy the certificates into the tls path

```sh
HOOP_PUBLIC_HOSTNAME=docker-compose-setup.hoop.dev
cp ./hoopdata/tls/$HOOP_PUBLIC_HOSTNAME/fullchain1.pem ./hoopdata/tls/ca.crt
cp ./hoopdata/tls/$HOOP_PUBLIC_HOSTNAME/cert1.pem ./hoopdata/tls/server.crt
cp ./hoopdata/tls/$HOOP_PUBLIC_HOSTNAME/privkey1.pem ./hoopdata/tls/server.key
```

##### DNS Configuration

For the setup to work, make sure to publish the following addresses pointing to the IP address of your machine.

- auth.$HOOP_PUBLIC_HOSTNAME
- app.$HOOP_PUBLIC_HOSTNAME

## Clean Up

Stop and remove all containers and volumes

```sh
docker-compose stop
docker-compose rm -y
```

## Troubleshooting

<AccordionGroup>
  <Accordion title="HSTS self signed certificates">
    If you are using a subdomain, your browser may restrict access due to an HSTS policy in your root domain. Try to use another domain or install the certificate authority (ca.crt) in your local system.
  </Accordion>
  <Accordion title="Terraform State Issues">
    We use Terraform to bootstrap the configuration with Zitadel; some issues may arise due to the state being inconsistent or not being cleaned properly. The command below will wipe all volumes, including the terraform state folder:
    ```sh
    docker-compose down -v
    ```
  </Accordion>
  <Accordion title="Apple Silicon Virtualization.framework issue">
    If you are using an Apple Silicon device, you may face the following error message:
    ```log
      Rosetta is only intended to run on Apple Silicon with a macOS host using Virtualization.framework with Rosetta mode enabled
    ```
    To solve this, go to your **Docker Desktop App Dashboard** > **Settings (top right gear icon)** > **General**; and make sure you have **Use Virtualization framework** enabled and **Use Rosetta for x86_64/amd64 emulation on Apple Silicon** disabled.
  </Accordion>
</AccordionGroup>
